
@{
    ViewData["Title"] = "ProductInsert";
}
@model ProductViewModel
<div class="site__body" id="body1">
    <div class="block">
        <div class="container">
            <div class="row">
                <div class="col-md-8 d-flex mt-4 mt-md-0">
                    <div class="card flex-grow-1 mb-0">
                        <div class="card-body">
                            <h3 class="card-title">ثبت کالا</h3>
                            <form asp-action="InsertProductConfirm" asp-controller="Product" enctype="multipart/form-data" data-ajax="true" data-ajax-Complete="F1">
                                <div class="form-group">
                                    <label>نام کالا</label>
                                    <input asp-for="Name" type="text" class="form-control" placeholder="نام کالا را وارد کنید">
                                </div>
                                <div class="form-group">
                                    <label>تعداد موجود</label>
                                    <input asp-for="Count" type="number" min="1" class="form-control" placeholder="تعداد کالا را وارد کنید">
                                </div>
                                <div class="form-group">
                                    <label>گروه محصول</label>

                                    <select asp-for="Group1Id" class="form-control">
                                        @foreach (var item in ViewData["Group1"] as List<Group1>)
                                        {
                                            <option value="@item.Id">@item.Name</option>
                                        }
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label>قیمت</label>
                                    <input asp-for="Price" type="text" class="form-control" placeholder="قیمت کالا را وارد کنید">
                                </div>
                                <div class="custom-file">
                                    <label class="custom-file-label">فایل اصلی(PDF)</label>
                                    <input asp-for="File" type="file" class="custom-file-input" placeholder="فایل pdf را وارد کنید">
                                </div>
                                <br />
                                <div class=" container-fluid">
                                    <div class="col-md-6 ">
                                        <label class="custom-file-label">تصویر کالا</label>
                                        <input id="ImgFile" asp-for="Img" type="file" class="custom-file-input">
                                    </div>


                                    <div class="col-md-3  " style=" margin:10px">
                                        <img width="100" id="img1" style="border-radius:10px" />
                                    </div>
                                </div>
                                <br />
                                <div>
                                    <button type="submit" class="btn btn-success mt-4 col-md-2">ثبت کالا</button>
                                    <div id="div1" class="col-md-2"></div>

                                </div>
                            </form>
                            <script>
                                $(function () {
                                    $(ImgFile).change(function () {
                                        let filereader = new FileReader();
                                        filereader.readAsDataURL(ImgFile.files[0]);
                                        filereader.onloadend = function (x) {
                                            $(img1).attr('src', x.target.result)
                                        }
                                        //$('.custom-file-label').html(ImgFile.files[0].name)

                                    })
                                    $(body1).click(function () {
                                        $(div1).html('')
                                    })
                                })
                                F1 = function (x) {
                                    i = x.responseText;
                                    if (i == "t") {
                                        $(div1).html('با موفقیت ثبت شد.')
                                        $(div1).css({ color: 'green' });
                                    } else {
                                        $(div1).html('ناموفق')
                                        $(div1).css({ color: 'red' })

                                    }
                                }

                            </script>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>